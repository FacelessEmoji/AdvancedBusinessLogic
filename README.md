Практическая работа №3: Проработка сложной бизнес-логики
Постановка задачи:
Спроектировать и реализовать агрегат TransportationOrder (Заявка на перевозку) с использованием паттернов предметно-ориентированного проектирования. Задание включает следующие аспекты:

Модель агрегата:

Агрегат TransportationOrder (корень агрегата):
Инкапсулирует всю бизнес-логику, связанную с жизненным циклом заявки.

Сопутствующие сущности:

Message – сообщение в заявке.

Attachment – вложение к сообщению.

OrderStatus – объект-значение для статуса заявки.

DeliveryRoute – объект-значение для маршрута доставки.

Инварианты и ограничения:

Сообщения могут добавляться только к активной заявке.

Вложения могут быть добавлены только вместе с сообщением.

Подтверждение сообщения доступно только для противоположной стороны (например, если сообщение отправлено клиентом, подтверждение может выполнить водитель).

Автоматическое закрытие заявки при отсутствии активности (реализация через механизм инвариантов).

Дополнительные требования:

Доменные сервисы:

OrderLifecycleService для управления статусами заявки (например, переход от активного состояния к закрытому).

FraudDetectionService для проверки подозрительной активности (выявление нецелевого использования транспортных ресурсов).

Repository:
Реализовать репозиторий для хранения и извлечения агрегатов TransportationOrder, обеспечивая согласованность данных внутри агрегата.